-- To avoid dealing with namespaces and imported scripts not
-- being able to access local variables, I've decided to inject
-- the source code when it's loaded on the filesystem.
--INJECT/turtleUtils


-- START OF LOCAL SCRIPT
local function moveToTopOfShaft(height)
    log (fine, "Entering moveToTopOfShaft(height="..height..")");
    currentLogIndent = currentLogIndent + 1;

    for i=1,height do
        move(up);
    end;
    if (height % 2 ~= 0) then
        turn(right);
    end;

    currentLogIndent = currentLogIndent - 1;
    log (fine, "Exiting moveToTopOfShaft()");
end;

print ("How many blocks down should the station roof be located? (Y - 13 is normal)");
local y = io.read();
y = tonumber(y);

print ("What radius of station should be built? (4 is normal)");
local d = io.read();
d = tonumber(d);

print ("What height of station should be built? (4 is normal)");
local h = io.read();
h = tonumber(h);

log (fine, "Entering BUILD_MINE(shaftDepth="..y..", stationRadius"..d..", stationHeight="..h..")");
currentLogIndent = currentLogIndent + 1;

shell.run("digShaft", y);
moveToTopOfShaft(y);
shell.run("prepareShaft", y);
shell.run("digStation", d, h);
shell.run("prepareStation", d, h);

currentLogIndent = currentLogIndent - 1;
log (fine, "Exiting BUILD_MINE()");