os.loadAPI("turtleUtils")

local args={... };
local z = args[1];
local darkness = 0;

local function mineShaft()
    for i = 1, z do
        moveWithDig(down);
        darkness = darkness + 1
        dig(forward);
        if not placeLadder() then
            --break
        end

        turn(right);
        if darkness >= 6 then
            dig(forward);
            selectWithOverflow(torchSlot)
            place(forward)
        end

        turn(right);
        dig(forward);
        selectWithOverflow(stonePipeSlot);
        place(forward);

        turn(left);
        turn(left);
        refuel()
    end
end;

local function moveToStartOfShaft()
    turn(right);
    turn(right);
    selectWithOverflow(smallChestSlot);
    place(forward);
    turn(left);
    turn(left);
end;

moveToStartOfShaft();
mineShaft();